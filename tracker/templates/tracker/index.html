{% extends "tracker/base.html" %}
<body id="tickets">
  {% block content %}
  <form method="post" id="filter" action="{% url 'index' %}">
    {% csrf_token %}
    <label for="ticket_status_id">Status:</label>
    <select name="ticket_status_id" id="ticket_status_id">
      <option value="">all</option>
      {% for s in statuses %}
      {% ifequal filter_status_id s.id %}
      <option selected value="{{s.id}}">{{s.status}}</option>
      {% else %}
      <option value="{{s.id}}">{{s.status}}</option>
      {% endifequal %}
      {% endfor %}
      <input type="submit" name="apply_filter" value="filter" />
    </select>
  </form>
  {% if latest_tickets %}
  <table class="tickets">
    <th>id</th>
    <th>text</th>
    <th>status</th>
    <th>assigned user</th>
    {% for ticket in latest_tickets %}
    <tr class="ticket" onclick="visit('{% url 'ticket' ticket.id %}')">
      <td class="id">{{ ticket.id }}</td>
      <td>{{ ticket.text}}</td>
      <td>{{ ticket.status.status }}</td>
      <td>{% firstof ticket.assigned_user.username "None" %}</td>
    </tr>
    {% endfor %}
  </table>
  {% else %}
  <p>No tickets are available.</p>
  {% endif %}
  {% endblock %}
</body>
